\documentclass[12pt,a4paper]{article}
\usepackage[style = authoryear, maxcitenames = 1, uniquelist=false, sorting = nyt, abbreviate = true, doi = true, backend = biber]{biblatex}
\usepackage[lmargin = 3.5cm, rmargin = 3.5cm, tmargin = 2.5cm, bmargin = 2.5cm]{geometry}
\usepackage[onehalfspacing]{setspace}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{times}
\usepackage{csquotes}
\usepackage[UKenglish]{babel}
\usepackage[textsize=tiny]{todonotes}
\usepackage[acronym]{glossaries}
\usepackage{soul} % for command \hl
\usepackage{pdfpages} % to insert pdf docs
\usepackage{csvsimple} % to import .csv files as tables
\usepackage{siunitx}
\usepackage{tikz}
\usepackage{caption} 
\usepackage{float}
\captionsetup[table]{skip=10pt} % more space between table and caption

\AtBeginBibliography{\small}
\addbibresource{main_sources.bib}

\setlength{\parindent}{0cm}
\setlength{\marginparwidth}{3.5cm} % make todonotes wider
\newcommand{\todoleft}[1]{{\reversemarginpar \todo{#1}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\def\findate{\today}


%title page
\thispagestyle{empty}
\begin{center}
    \Large{University of Innsbruck \\ Faculty of Mathematics, Computer Science and Physics} \\
    \vspace{3mm}
    \large{Institute for Theoretical Physics}
    \vspace{10mm}

    \includegraphics[width = 0.6 \linewidth]{logo.jpg}

    \vspace{10mm}
    \Large{Bachelor Thesis} \\
    \large{submitted for the degree of} \\
    \Large{Bachelor of Science} \\
    \vspace{10mm}
    \LARGE{\textbf{An information-theoretical approach to internal models in a Partially Observable Markov Decision Process}} \\
    \vspace{10mm}

    \large{by \\ Lukas Prader \\ Matriculation Nr.: 12115058 \\ SE Seminar with Bachelor Thesis}
\end{center}

\vspace{30mm}
\begin{tabular}{ll}
    \large{Submission Date:} & \large{\findate}                          \\
    \large{Supervisors:}     & \large{Alexander Vining, Hans J  Briegel} \\
\end{tabular}


\newpage
\thispagestyle{empty}
\begin{abstract}
    Lorem ipsum
\end{abstract}

\pagenumbering{roman}

\newpage
\tableofcontents
\thispagestyle{empty}
\newpage
\pagenumbering{arabic}

\section{Introduction} \label{sec:introduction}

\section{Methods} \label{sec:methods}

\begin{figure}[H]
    \centering
    % delayed action mdp
    \begin{tikzpicture}[->,shorten >=1pt,auto,node distance=3cm,
            thick,main node/.style={circle,draw,font=\sffamily\Large\bfseries}]

        \node[fill=gray!50, circle, draw=black] (0) at (0,0) {$S_0$};
        \node[fill=cyan!50, circle, draw=black] (1) at (-1.5,-3) {$S_1$};
        \node[fill=cyan!50, circle, draw=black] (2) at (2,-1.5) {$S_2$};

        \path[every node/.style={font=\sffamily\scriptsize}]
        (0) edge [in=175,out=115, loop] node[above=3pt] {$(1-p(x)) \pi(a_0)$} (0)
        (0) edge [in=65,out=5, loop] node[above=3pt] {$(1-p(x)) \pi(w_0)$} (0)
        (0) edge [in=120,out=180] node[above, rotate=62] {$p(x) \pi(a_0)$} (1)
        (0) edge [bend right] node[below, rotate=62] {$p(x) \pi(w_0)$} (1)
        (1) edge [bend right] node[above, rotate=62] {$\pi(a_1)$} (0)
        (1) edge [bend right] node[rotate=18] {$\pi(w_1)$} (2)
        (2) edge [bend left] node[above, rotate=-42] {$\pi(w_2)$} (0)
        (2) edge [bend right, black!50!green] node[above, rotate=-42] {$\pi(a_2)$} (0);

    \end{tikzpicture}
    \caption{\label{fig:delayed_mdp} Graph showing the delayed action MDP}
\end{figure}

% delayed action with light observation
\begin{tikzpicture}[->,shorten >=1pt,auto,node distance=3cm,
        thick,main node/.style={circle,draw,font=\sffamily\Large\bfseries}]

    \node[fill=gray!50, circle, draw=black] (0) at (0,0) {$S_0$};
    \node[fill=cyan!50, circle, draw=black] (1) at (-1.5,-3) {$S_1$};
    \node[fill=cyan!50, circle, draw=black] (2) at (2,-1.5) {$S_2$};
    \node[fill=gray!50, circle, draw=black] (D) at (4,0) {$D$};
    \node[fill=cyan!50, circle, draw=black] (L) at (4,-3) {$L$};

    \path[every node/.style={font=\sffamily\scriptsize}]
    (0) edge [in=175,out=115, loop] node[above=3pt] {$(1-p(x)) \pi(a_0)$} (0)
    (0) edge [in=65,out=5, loop] node[above=3pt] {$(1-p(x)) \pi(w_0)$} (0)
    (0) edge [in=120,out=180] node[above, rotate=62] {$p(x) \pi(a_0)$} (1)
    (0) edge [bend right] node[below, rotate=62] {$p(x) \pi(w_0)$} (1)
    (1) edge [bend right] node[above, rotate=62] {$\pi(a_1)$} (0)
    (1) edge [bend right] node[rotate=18] {$\pi(w_1)$} (2)
    (2) edge [bend left] node[above, rotate=-42] {$\pi(w_2)$} (0)
    (2) edge [bend right, black!50!green] node[above, rotate=-42] {$\pi(a_2)$} (0)
    (0) edge [dotted] node[above] {$\Omega_L$} (D)
    (1) edge [dotted] node[below] {$\Omega_L$} (L)
    (2) edge [dotted] node[above, rotate=-38] {$\Omega_L$} (L);

\end{tikzpicture}

% reduced markov processes of observations
\begin{figure}[H]
    \centering
    \begin{tikzpicture}[->,shorten >=1pt,auto,node distance=3cm,
            thick,main node/.style={circle,draw,font=\sffamily\Large\bfseries}]

        \node[fill=gray!50, circle, draw=black] (D) at (4,0) {$D$};
        \node[fill=cyan!50, circle, draw=black] (L) at (4,-2.5) {$L$};
        \node[fill=gray!50, circle, draw=black] (A) at (8,0) {$A$};
        \node[fill=gray!50, circle, draw=black] (W) at (8,-2.5) {$W$};

        \path[every node/.style={font=\sffamily\scriptsize}]
        (D) edge [in=110,out=70, loop] node[above] {$1-p(x)$} (D)
        (D) edge [bend right] node[above, rotate=90] {$p(x)$} (L)
        (L) edge [bend right] node[below, rotate=90] {$\mu(S_1)\pi(a_1) + \mu(S_2)$} (D)
        (L) edge [in=290,out=250, loop] node[below] {$\mu(S_1)\pi(w_1)$} (L)
        (A) edge [in=110,out=70, loop] node[above] {$P(\pi_a)$} (A)
        (A) edge [bend right] node[above, rotate=90] {$P(\pi_w)$} (W)
        (W) edge [bend right] node[below, rotate=90] {$P(\pi_a)$} (A)
        (W) edge [in=290,out=250, loop] node[below] {$P(\pi_w)$} (W);

    \end{tikzpicture}
    \caption{\label{fig:reduced_mps} Reduced models for Observation of light (left) and action (right).}
\end{figure}

\begin{figure}
    \centering
    % L=2 light process
    \begin{tikzpicture}[->,shorten >=1pt,auto,node distance=3cm,
            thick,main node/.style={circle,draw,font=\sffamily\Large\bfseries}]

        \node[fill=gray!50, circle, draw=black] (DD) at (0,3.5) {$DD$};
        \node[fill=gray!50, circle, draw=black] (LD) at (3.5,3.5) {$LD$};
        \node[fill=cyan!50, circle, draw=black] (DL) at (0,0) {$DL$};
        \node[fill=cyan!50, circle, draw=black] (LL) at (3.5,0) {$LL$};

        \path[every node/.style={font=\sffamily\scriptsize}]
        (DD) edge [in=175,out=115, loop] node[right=1cm] {$1-p(x)$} (DD)
        (DD) edge node[left] {$p(x)$} (DL)
        (DL) edge [bend right=10]  node[below, rotate=45] {$\pi(a_1)$} (LD)
        (LD) edge [bend right=10]  node[above, rotate=45] {$p(x)$} (DL)
        (LD) edge node[above] {$1-p(x)$} (DD)
        (DL) edge node[below] {$\pi(w_1)$} (LL)
        (LL) edge node[right] {$1$} (LD);

    \end{tikzpicture}
    \caption{\label{fig:mp1_L2} Internal model with sufficient complexity.}
\end{figure}

\section{Results} \label{sec:results}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\linewidth]{../figures/mp1_vs_obsL.png}
    \caption{\label{fig:mp1_vs_obsL} Plot showing the difference between MP1 and the MDP.}
\end{figure}

Talk about behaviour correlating to order 2 of process, in agreement with Crutchfield.
Also do the same plot for MP2 and action as well, showing hidden Markov convergence.

\newpage
\begin{figure}[H]
    \centering
    \includegraphics[width=1\linewidth]{../figures/block_entropy_estimation.png}
    \caption{\label{fig:mp1_vs_obsL} Plot showing the bias and variance of the plug in estimator for block Entropy.}
\end{figure}

$$\hat{H}(s^L) = -\sum_i \frac{n_i}{N} \log_2{\frac{n_i}{N}}$$

(Lesne et al.) (10.1103/PhysRevE.79.046208) Entropy estimation of short (time correlated) sequences
Upper bound on block length given a sequence of observations, in order to have good estimates:
$$ n \leq \frac{N h_\mu}{\ln(k)} $$

with word length $n$, length of observation sequence $N$ and number of symbols $k$.

They propose first estimating the entropy rate using Lempel-Ziv complexity(iterative algorithm moving through sequence), then setting the sequence length/word length accordingly.

$$ \hat{L}_0 = \frac{\mathcal{N}_w \ln(N)}{N},\ \hat{L}=\frac{\mathcal{N}_w[1+\log_k\mathcal{N}_w]}{N},\ \lim_{n \to \infty}\hat{L} = \frac{h_\mu}{\ln(k)} $$

With $N$ the length of the observation sequence and $\mathcal{N}_w$ parsed words from the Lempel-Ziv algorithm.
For the plug in estimator, error bars are computable, meaning computable confidence intervals.

Larson et al. (10.1016/j.procs.2011.04.172) use
$$ \mathcal{L} h_\mu \geq L|A|^L \ln|A| $$
solving for $L$ given $\mathcal{L}$ returns $W(\mathcal{L} h_\mu) / \ln|A|$ (mathematica), with the Lambert $W$ function.
(gives better estimate)

\begin{figure}
    \centering
    \includegraphics[width=0.5\linewidth]{../figures/predictability_gain_estimation.png}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=0.5\linewidth]{../figures/predictability_gain_estimation_optimal.png}
\end{figure}

deviation from analytical:
[-0.00365034217876947 -0.00365907607011157 -0.0124851947847702
 -0.0251811425394552]

\section{Conclusion} \label{sec:conclusion}


\section{Acknowledgements} \label{sec:acknowledgements}


\clearpage
\section*{Declaration of Authorship}

I hereby solemnly declare, by my own signature, that I have independently authored the presented work and have not used any sources or aids other than those indicated. All passages taken verbatim or in content from the specified sources are identified as such.

I consent to the archiving of this Bachelor thesis.

\hfill
\vspace{2cm} Innsbruck, \findate \hfill Lukas Prader \includegraphics[height = 10mm]{"signature.png"}


\newpage
\printbibliography[]
\input{appendix}

\end{document}